<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v4.0.1">
    <title>Dashboard Template Â· Bootstrap</title>
    <!-- <script src="knScriptfunctions.js"></script> -->
    <!-- src
        â””â”€â”€ main
            â””â”€â”€ resources
                â””â”€â”€ static
                    â””â”€â”€ knScriptfunctions.js 
        -->

    <link rel="canonical" href="https://getbootstrap.com/docs/4.5/examples/dashboard/">

    <!-- Bootstrap core CSS -->
    <!--<link href="../assets/dist/css/bootstrap.css" rel="stylesheet">-->
    <link href="../assets/dist/css/bootstrap.css" th:href="@{/webjars/bootstrap/4.5.0/css/bootstrap.css}"
        rel="stylesheet">
    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }
        /* æ·»åŠ ä»¥ä¸‹æ ·å¼ */
        .nav-tabs .nav-link.active {
            color: #fff !important;
            background-color: #ff009d !important;
            border-color: #ff009d #ff009d #fff !important;
        }
        
        .nav-tabs .nav-link:hover {
            border-color: #ff009d #ff009d #fff;
        }

        /* æŠ˜å é¢æ¿ç›¸å…³æ ·å¼ */
        .card-header {
            background-color: #f8f9fa;
        }
        
        .btn-link {
            color: #333;
            text-decoration: none;
            width: 100%;
            text-align: left;
        }
        
        .btn-link:hover {
            color: #007bff;
            text-decoration: none;
        }
        
        .card {
            border: 1px solid rgba(0,0,0,.125);
            border-radius: .25rem;
        }
        
        .indented {
            margin-left: 20px;
            margin-bottom: 10px;
        }

        /* ===== æ–°å¢ï¼šæ‹¼è¯¾åŠŸèƒ½ç›¸å…³æ ·å¼ ===== */
        .assembled-row {
            background-color: #f0f0f0 !important;
            color: #888 !important;
        }

        .lesson-checkbox {
            margin-right: 8px;
        }

        .assembled-section {
            margin-top: 30px;
            border-top: 2px solid #007bff;
            padding-top: 15px;
        }

        .assembled-header {
            background-color: #e3f2fd;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
        }

        .progress-info {
            font-size: 12px;
            color: #666;
            margin-left: 10px;
        }

        .fragments-section {
            margin-bottom: 20px;
        }

        .fragments-header {
            background-color: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            border-left: 4px solid #ffc107;
        }
    </style>
    <!-- Custom styles for this template -->
    <link href="dashboard.css" th:href="@{/dashboard/dashboard.css}" rel="stylesheet">
</head>

<body>
    <div th:replace="~{commons/bar::topbar}"></div>
    <div class="container-fluid">
        <div class="row">
            <div th:replace="~{commons/bar::sidebar(activeUri='kn_pieses_hasbeen_sche_link_active')}"></div>
            <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
                <h2 class="mt-4 mb-2">ç¢è¯¾å·²æ¢æˆæ­£è¯¾</h2>

                <!-- ä¸šåŠ¡è¯´æ˜éƒ¨åˆ† - ä½¿ç”¨BootstrapæŠ˜å ç»„ä»¶ -->
                <div class="business-description mb-4">
                    <!-- æ£€ç´¢éƒ¨ä¸šåŠ¡è¯´æ˜æŠ˜å ç»„ä»¶ -->
                    <div class="card">
                        <div class="card-header" id="searchDescriptionHeader">
                            <h5 class="mb-0">
                                <button class="btn btn-link" type="button" data-toggle="collapse" 
                                        data-target="#searchDescriptionCollapse" aria-expanded="true" 
                                        aria-controls="searchDescriptionCollapse">
                                    â˜…æ£€ç´¢éƒ¨ä¸šåŠ¡è¯´æ˜
                                </button>
                            </h5>
                        </div>
                        <div id="searchDescriptionCollapse" class="collapse" 
                             aria-labelledby="searchDescriptionHeader">
                            <div class="card-body">
                                <dl>
                                    <dd class="indented">â‘ </dd>
                                    <dd class="indented">â‘¡</dd>
                                    <dd class="indented">â‘¢</dd>
                                    <dd class="indented">â‘¢</dd>
                                </dl>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- æ¤œç´¢éƒ¨ -->
                <form action="#" th:action="@{/kn_pieses_hasbeen_sche/search}" th:object="${searchForm}" method="get">
                    <div class="form-row align-items-end">
                        <div class="form-group col-md-1">
                            <label>å¹´åº¦</label>
                            <select class="form-control" id="lsnfeeyear" name="selectedyear">
                                <!-- ä½¿ç”¨Thymeleafè¯­æ³•åŠ¨æ€å¡«å……å¹´åº¦ä¸‹æ‹‰åˆ—è¡¨æ¡†çš„é€‰é¡¹ -->
                                <option th:each="year : ${knyearlist}" 
                                        th:value="${year}" 
                                        th:text="${year}" 
                                        th:selected="${year == (extra2ScheMap!= null ? extra2ScheMap['selectedyear'] : '')}"></option>
                            </select>
                        </div>
                        <div class="form-group col-md-2">
                            <label>å­¦ç”Ÿå§“å</label> 
                            <select class="form-control" id="studentSelect" name="stuId">
                                <option value="">è¯·é€‰æ‹©</option>
                            </select>
                        </div>
                        <div class="form-group col-md-1">
                            <button type="submit" class="btn btn-primary">æ¤œ ç´¢</button>
                       </div>
                    </div>
                    <hr />

                    <!-- æ˜ç»†éƒ¨ä¸šåŠ¡è¯´æ˜æŠ˜å ç»„ä»¶ -->
                    <div class="card mt-4">
                        <div class="card-header" id="detailDescriptionHeader">
                            <h5 class="mb-0">
                                <button class="btn btn-link" type="button" data-toggle="collapse" 
                                        data-target="#detailDescriptionCollapse" aria-expanded="true" 
                                        aria-controls="detailDescriptionCollapse">
                                    æ˜ç»†éƒ¨ä¸šåŠ¡è¯´æ˜
                                </button>
                            </h5>
                        </div>
                        <div id="detailDescriptionCollapse" class="collapse" 
                             aria-labelledby="detailDescriptionHeader">
                            <div class="card-body">
                                <dl>
                                    <dd class="indented">â‘ é€‰æ‹©é›¶ç¢è¯¾ï¼šåœ¨æ¯ä¸ªå­¦ç”Ÿçš„é›¶ç¢è¯¾æ˜ç»†ä¸­ï¼Œå‹¾é€‰checkboxæ¥é€‰æ‹©è¦æ‹¼å‡‘çš„è¯¾ç¨‹</dd>
                                    <dd class="indented">â‘¡æ‹¼è¯¾è§„åˆ™ï¼šåªæœ‰ç›¸åŒç§‘ç›®ç¼–å·çš„è¯¾ç¨‹å¯ä»¥æ‹¼å‡‘ï¼Œæ—¶é•¿ç´¯è®¡å¿…é¡»æ°å¥½ç­‰äºè¯¥ç§‘ç›®çš„æ ‡å‡†è¯¾æ—¶</dd>
                                    <dd class="indented">â‘¢è‡ªåŠ¨ç¦ç”¨ï¼šå½“é€‰ä¸­è¯¾ç¨‹æ—¶é•¿æ°å¥½ç­‰äºæ ‡å‡†æ—¶é•¿æ—¶ï¼Œè¯¥ç§‘ç›®å…¶ä»–è¯¾ç¨‹å°†è‡ªåŠ¨ç¦ç”¨</dd>
                                    <dd class="indented">â‘£æ•´è¯¾ç”Ÿæˆï¼šæ‹¼å‡‘æˆåŠŸçš„è¯¾ç¨‹å°†è‡ªåŠ¨æ˜¾ç¤ºåœ¨"æ‹¼å‡‘å®Œæˆçš„æ•´èŠ‚è¯¾æ˜ç»†"ä¸­</dd>
                                    <dd class="indented">â‘¤æ‹†åˆ†åŠŸèƒ½ï¼šå¯ä»¥é€šè¿‡"æ‹†åˆ†"æŒ‰é’®å–æ¶ˆå·²æ‹¼å‡‘çš„æ•´èŠ‚è¯¾</dd>
                                </dl>
                            </div>
                        </div>
                    </div>

                    <!-- å¦‚æœæ²¡æœ‰å­¦ç”Ÿçš„å·²æ”¯ä»˜ä¿¡æ¯ï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯ -->
                    <style>
                        .no-info-message {
                            font-size: 18px;
                        }
                    </style>
                    
                    <div class="form-group" th:if="${infoListPicesExtra == null || #lists.isEmpty(infoListPicesExtra)}">
                        <p class="no-info-message">ç›®å‰æ²¡æœ‰å­¦ç”Ÿé›¶ç¢çš„è¯¾ç¨‹ä¿¡æ¯ï¼</p>
                    </div>
                </form>

                <!-- æ˜ç´°éƒ¨ Tab ä»¥å­¦ç”Ÿä¸ºå•ä½çš„ Tabå¯¼èˆª -->
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li th:each="entry, iterStat : ${resultsTabStus}" class="nav-item">
                        <a th:classappend="${iterStat.index == 0} ? 'nav-link active' : 'nav-link'"
                            th:id="${entry.key + '-tab'}" data-toggle="tab" th:href="'#' + ${entry.key}" role="tab"
                            th:aria-controls="${entry.key}"
                            th:aria-selected="${iterStat.index == 0} ? true : false">[[${entry.value}]]</a>
                    </li>
                </ul>
                <!-- Tab å¡ç‰‡é¡¹é‡Œæ˜¾ç¤º å­¦ç”Ÿçš„æ’è¯¾ä¸€è§ˆ -->
                <div class="tab-content" id="myTabContent">
                    <div th:each="entry, iterStat : ${resultsTabStus}" th:id="${entry.key}" class="tab-pane fade"
                        th:classappend="${iterStat.index == 0} ? 'show active' : ''" role="tabpanel"
                        th:aria-labelledby="${entry.key + '-tab'}">
                        <div
                            th:replace="kn_lsn_extra_pis_hsbn_sche/tab_pis_hsbn_sche_by_stu :: lessonTable(${entry.key}, ${entry.value})">
                        </div>
                    </div>
                </div>
            </main>
            <!-- å‰Šé™¤å‡¦ç†-->
            <form id="deleteEmpForm" action="" method="post">
                <input type="hidden" name="_method" value="Delete" />
            </form>
        </div>
    </div>
    <!--Bootstrap core JavaScrip
=============================-->
    <script type="text/javascript" th:src="@{/webjars/jquery/3.5.1/jquery.slim.min.js}"></script>
    <script type="text/javascript" th:src="@{/webjars/popper.js/1.16.0/umd/popper.min.js}"></script>
    <script type="text/javascript" th:src="@{/webjars/bootstrap/4.5.0/js/bootstrap.min.js}"></script>

    <!-- Icons -->

    <!-- å‰Šé™¤ãƒ—ãƒ­ã‚»ã‚¹ã«ã¯ã€JSã§å‰Šé™¤ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã§å®Ÿç¾ã™ã‚‹-->
    <script>
        $(".deleteBtn").click(function () {
            if (confirm('æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                //thisãŒå‰Šé™¤ãƒœã‚¿ãƒ³ã§ã‚ã‚‹
                let del_uri = $(this).attr("liu_del_uri");
                //å¯¾è±¡ãƒ•ã‚©ãƒ¼ãƒ ã®submitã‚’å®Ÿè¡Œã™ã‚‹
                $("#deleteEmpForm").attr("action", del_uri).submit();
                return false;
            }
        });
    </script>
    <!-- åˆæœŸè¯å­¦ç”Ÿä¸‹æ‹‰åˆ—è¡¨æ¡† -->
    <script th:inline="javascript">
        // ä»åç«¯ä¼ é€’çš„å­¦ç”Ÿæ•°æ®
        var jsonStuSubList = /*[[${extra2ScheStuList}]]*/ [];
        
        // é¡µé¢åŠ è½½å®Œæˆåï¼Œåˆå§‹åŒ–å­¦ç”Ÿä¸‹æ‹‰åˆ—è¡¨
        window.onload = function() {
            // åˆå§‹åŒ–å·²ç»“ç®—è¯¾ç¨‹çš„å­¦ç”Ÿ
            var studentSelect = document.getElementById('studentSelect');
            var selectedStuId = /*[[${extra2ScheMap != null ? extra2ScheMap['stuId'] : ''}]]*/ '';
            
            console.log('å®Œæ•´çš„extra2ScheMap:', /*[[${extra2ScheMap}]]*/ {});
            var selectedStuId = /*[[${extra2ScheMap != null ? extra2ScheMap['stuId'] : ''}]]*/ '';
            console.log('è·å–åˆ°çš„selectedStuId:', selectedStuId);

            var uniqueStudentIds = new Set(); // ä½¿ç”¨é›†åˆæ¥é¿å…é‡å¤
            
            // ä»stuSubListæ·»åŠ å­¦ç”Ÿå§“ååˆ°ä¸‹æ‹‰åˆ—è¡¨ï¼Œç¡®ä¿ä¸é‡å¤
            jsonStuSubList.forEach(function(item) {
                if (!uniqueStudentIds.has(item.stuId)) {
                    uniqueStudentIds.add(item.stuId);
                    var option = new Option(item.stuName, item.stuId);
                    // å‘ChatGPTï¼Œæ­¤å¤„ç”¨stuIdç‰¹å®šstuNameèµ‹å€¼ç»™ä¸‹æ‹‰åˆ—æ¡†
                    if (item.stuId === selectedStuId) {
                        option.selected = true;
                    }
                    studentSelect.add(option);
                }
            });

            // ğŸ”§ 2026-01-08 ä¿®å¤ï¼šæ·»åŠ å¹´åº¦å˜åŒ–ç›‘å¬å™¨ï¼Œå½“å¹´åº¦å˜åŒ–æ—¶è‡ªåŠ¨æäº¤è¡¨å•é‡æ–°æŸ¥è¯¢å­¦ç”Ÿåˆ—è¡¨
            document.getElementById('lsnfeeyear').addEventListener('change', function() {
                this.closest('form').submit();
            });
        };
    </script>
</body>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const yearSelect = document.getElementById('lsnfeeyear');
        
        yearSelect.addEventListener('change', function() {
            const selectedYear = this.value;
            
            // åˆ›å»ºä¸€ä¸ªä¸´æ—¶è¡¨å•æ¥æäº¤è¯·æ±‚
            const form = document.createElement('form');
            form.method = 'GET';
            form.action = `/liu/kn_pieses_into_one/${selectedYear}`;
            document.body.appendChild(form);
            form.submit();
        });
    });
</script>
</html>