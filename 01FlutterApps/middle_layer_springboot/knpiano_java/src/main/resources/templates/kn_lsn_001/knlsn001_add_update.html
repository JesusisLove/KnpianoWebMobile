<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v4.0.1">
    <title>Dashboard Template ¬∑ Bootstrap</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/4.5/examples/dashboard/">

    <link href="../assets/dist/css/bootstrap.css" th:href="@{/webjars/bootstrap/4.5.0/css/bootstrap.css}"
        rel="stylesheet">
    <!-- ÂºïÂÖ• Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <!-- ÂºïÂÖ• Bootstrap DateTime Picker CSS -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css">
    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }

        /* È°µÈù¢Ê†áÈ¢òÊ†∑Âºè */
        .page-title {
            background: #6c5ce7;
            color: white;
            padding: 20px 30px;
            border-radius: 8px;
            margin: 20px 0;
            border: none;
        }

        .page-title h2 {
            margin: 0;
            font-weight: 600;
            font-size: 24px;
        }

        /* Ë°®ÂçïÂå∫ÂüüÊ†∑Âºè */
        .form-section {
            background: #dff0d8;
            border: 2px solid #5cb85c;
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
        }

        .form-title {
            background: #5cb85c;
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 18px;
            margin-bottom: 25px;
            display: inline-flex;
            align-items: center;
        }

        .form-title::before {
            content: 'üìù';
            margin-right: 10px;
            font-size: 20px;
        }

        /* Ë°®ÂçïËæìÂÖ•Ê†∑Âºè */
        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            font-weight: 600;
            color: #5cb85c;
            margin-bottom: 8px;
            font-size: 14px;
            display: block;
        }

        .form-control {
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 12px 15px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: white;
        }

        .form-control:focus {
            border-color: #5cb85c;
            box-shadow: 0 0 0 0.1rem rgba(92, 184, 92, 0.25);
            background: white;
            outline: none;
        }

        .form-control:disabled,
        .form-control[readonly] {
            background: #f5f5f5;
            border-color: #ccc;
            color: #666;
        }

        /* ÊåâÈíÆÂÆπÂô®Ê†∑Âºè */
        .button-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
        }

        /* ÊåâÈíÆÊ†∑Âºè */
        .btn-primary,
        .btn-save {
            background: #5cb85c !important;
            border: none !important;
            color: white !important;
            padding: 12px 24px !important;
            border-radius: 6px !important;
            font-weight: 600 !important;
            font-size: 14px !important;
            transition: all 0.3s ease !important;
        }

        .btn-primary:hover,
        .btn-save:hover {
            background: #4cae4c !important;
            color: white !important;
        }

        /* ËøîÂõûÊåâÈíÆÊ†∑Âºè */
        .btn-back {
            background: #6c757d !important;
            border: none !important;
            color: white !important;
            padding: 12px 24px !important;
            border-radius: 6px !important;
            font-weight: 600 !important;
            font-size: 14px !important;
            transition: all 0.3s ease !important;
            text-decoration: none !important;
            display: inline-block !important;
        }

        .btn-back:hover {
            background: #5a6268 !important;
            color: white !important;
            text-decoration: none !important;
        }

        /* ÁâπÊÆäÂ≠óÊÆµÊ†∑Âºè */
        .readonly-field {
            position: relative;
        }

        .readonly-field::after {
            content: 'üîí';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #5cb85c;
            font-size: 16px;
            z-index: 10;
        }

        .auto-generated {
            position: relative;
        }

        .auto-generated::after {
            content: '‚öôÔ∏è';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #5cb85c;
            font-size: 16px;
            z-index: 10;
        }

        /* Radio ÊåâÈíÆÁªÑÊ†∑Âºè‰ºòÂåñ */
        .radio-group {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 6px;
            padding: 20px;
            margin: 15px 0;
            border: 1px solid #ddd;
        }

        .radio-group .form-check {
            display: block;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 4px;
            transition: all 0.3s ease;
            border: 1px solid #e0e0e0;
        }

        .radio-group .form-check:hover {
            background: rgba(92, 184, 92, 0.1);
            transform: translateX(5px);
            border-color: #5cb85c;
        }

        .radio-group .form-check-input {
            margin-top: 0.3rem;
            margin-right: 10px;
        }

        .radio-group .form-check-input:checked {
            background-color: #5cb85c;
            border-color: #5cb85c;
        }

        .radio-group .form-check-label {
            font-weight: 500;
            color: #333;
            cursor: pointer;
        }

        /* ‰∏ãÊãâÈÄâÊã©Ê°ÜÊ†∑Âºè */
        select.form-control {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%235cb85c' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.75rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            size: 1;
        }

        select.form-control option {
            padding: 8px 15px;
            font-size: 14px;
            line-height: 1.5;
            background: white;
            color: #333;
            border: none;
        }

        select.form-control option:hover,
        select.form-control option:focus {
            background-color: #f5f5f5;
            color: #333;
        }

        select.form-control option:checked {
            background-color: #5cb85c;
            color: white;
        }

        select.form-control {
            max-height: none;
            overflow-y: auto;
        }

        #studentSelect,
        #subjectSelect,
        #lsnduration {
            min-height: 45px;
        }

        select[name*="bank"], 
        select[id*="bank"] {
            height: auto;
            min-height: 45px;
        }

        .input-group-append .input-group-text {
            min-width: 60px;
            background: #5cb85c;
            border-color: #5cb85c;
            color: white;
        }
        
        .datetime-container {
            margin-bottom: 20px;
        }
        
        .datetime-container label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #5cb85c;
        }

        /* Êó•ÊúüËæìÂÖ•Ê°ÜÊ†∑Âºè */
        input[type="date"],
        input[type="datetime-local"] {
            border: 1px solid #ccc;
            border-radius: 4px;
            background: white;
            padding: 12px 15px;
            font-size: 14px;
        }

        input[type="date"]:focus,
        input[type="datetime-local"]:focus {
            border-color: #5cb85c;
            box-shadow: 0 0 0 0.1rem rgba(92, 184, 92, 0.25);
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .page-title h2 {
                font-size: 20px;
            }
            
            .form-section {
                padding: 20px;
            }
            
            .form-title {
                font-size: 16px;
                padding: 10px 16px;
            }

            .radio-group {
                padding: 15px;
            }

            .btn-primary,
            .btn-back {
                padding: 10px 20px !important;
                font-size: 14px !important;
                width: auto;
                min-width: 120px;
            }
            
            .button-container {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Âä®ÁîªÊïàÊûú */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-section {
            animation: fadeIn 0.5s ease-out;
        }

        /* Ë°®ÂçïÈ™åËØÅÊ†∑Âºè */
        .form-control.is-valid {
            border-color: #5cb85c;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 8 8'%3e%3cpath fill='%235cb85c' d='m2.3 6.73.94-.94 2.94-2.94-1.34-1.34L3.5 3.54l-.61-.61L1.55 4.27z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right calc(0.375em + 0.1875rem) center;
            background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
        }

        .form-control.is-invalid {
            border-color: #dc3545;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='none' stroke='%23dc3545' viewBox='0 0 12 12'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath d='m5.8 3.6.7.8L6 5.3l-.5-.9z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right calc(0.375em + 0.1875rem) center;
            background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
        }

        /* ÈîôËØØÊ∂àÊÅØÊ†∑Âºè */
        .alert-danger {
            background: #e17055;
            border: none;
            border-radius: 8px;
            color: white;
            margin: 20px 0;
            animation: fadeIn 0.5s ease-out;
        }

        /* ÈöêËóèÂ≠óÊÆµÊ†∑Âºè */
        input[type="hidden"] {
            display: none;
        }

        /* Âç†‰ΩçÁ¨¶ÊñáÊú¨È¢úËâ≤ */
        .form-control::placeholder {
            color: #6c757d;
            opacity: 0.8;
        }

        /* ÈÄâÊã©Ê°ÜÈÄâ‰∏≠Áä∂ÊÄÅ */
        .form-control option:checked {
            background-color: #5cb85c;
            color: white;
        }
    </style>
    <link href="dashboard.css" th:href="@{/dashboard/dashboard.css}" rel="stylesheet">
</head>

<body>

    <div th:replace="~{commons/bar::topbar}"></div><!-- thymeleaf ÂÖ¨ÂÖ±ÁâáÊÆµÁöÑÊäΩÂèñÂíåÂºïÁî®ÔºöÂú®Ê≠§ÂºïÁî®ÊäΩÂèñÁöÑÁâáÊÆµ -->
    <div class="container-fluid">
        <div class="row">
            <div th:replace="~{commons/bar::sidebar(activeUri='kn_lsn_001_link_active')}"></div>
            <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
                <!-- È°µÈù¢Ê†áÈ¢ò -->
                <div class="page-title">
                    <h2>üìö ÊéàÊ•≠ÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†</h2>
                </div>

                <!-- Ë°®ÂçïÂå∫Âüü -->
                <div class="form-section">
                    <div class="form-title">ËØæÁ®ã‰ø°ÊÅØÂΩïÂÖ•</div>
                    
                    <!-- ÊòæÁ§∫ÈîôËØØÊ∂àÊÅØ -->
                    <div th:if="${errorMessageList}" class="alert alert-danger" role="alert">
                        <div th:each="errorMessage : ${errorMessageList}">
                            <p th:text="${errorMessage}"></p>
                        </div>
                    </div>
                    
                    <form th:action="@{/kn_lsn_001}" method="post">
                        <input type="hidden" name="_method" value="put" th:if="${selectedinfo!=null}" />

                        <div class="form-group auto-generated">
                            <label>ËØæÁ®ãÁºñÂè∑</label>
                            <input name="lessonId" type="text" class="form-control" placeholder="„Ç∑„Çπ„ÉÜ„É†Ëá™ÂãïÊé°Áï™„ÄÅÂÖ•Âäõ‰∏çÂèØ" readonly
                                th:value="${selectedinfo!=null}?${selectedinfo.lessonId}">
                        </div>

                        <!-- Êñ∞Ë¶èÁôªÈå≤ Ê®°Âºè‰∏ã Â≠¶ÁîüÂßìÂêçÁî® ‰∏ãÊãâÂàóË°®Ê°ÜÊòæÁ§∫ -->
                        <div class="form-group"
                            th:if="${(selectedinfo==null ) || (#strings.isEmpty(selectedinfo.lessonId))}">
                            <label>Â≠¶ÁîüÂßìÂêç</label>
                            <select class="form-control" id="studentSelect" name="stuId">
                                <option value="">ËØ∑ÈÄâÊã©</option>
                                <!-- Âä®ÊÄÅÂÜÖÂÆπÂ∞ÜË¢´ÊèíÂÖ• -->
                            </select>
                        </div>

                        <!-- Â§âÊõ¥Á∑®ÈõÜ Ê®°Âºè‰∏ã Â≠¶ÁîüÂßìÂêçÁî® ÊñáÊú¨Ê°Ü‰∏îreadonlyÊòæÁ§∫ -->
                        <div class="form-group readonly-field" th:if="${selectedinfo!=null && (!#strings.isEmpty(selectedinfo.lessonId))}">
                            <label>Â≠¶ÁîüÂßìÂêç</label>
                            <input name="stuName" type="text" class="form-control" th:value="${selectedinfo.stuName}"
                                readonly>
                            <input name="stuId" type="hidden" class="form-control" th:value="${selectedinfo.stuId}">
                        </div>

                        <!-- Êñ∞Ë¶èÁôªÈå≤ Ê®°Âºè‰∏ã ÁßëÁõÆÂêçÁß∞Áî® ‰∏ãÊãâÂàóË°®Ê°ÜÊòæÁ§∫ -->
                        <div class="form-group"
                            th:if="${(selectedinfo==null) || (#strings.isEmpty(selectedinfo.lessonId))}">
                            <label>ÁßëÁõÆÂêçÁß∞</label>
                            <select class="form-control" id="subjectSelect" name="subjectId">
                                <option value="">ËØ∑ÈÄâÊã©</option>
                            </select>
                        </div>

                        <!-- Êñ∞Ë¶èÁôªÈå≤ Ê®°Âºè‰∏ã Â≠êÁßëÁõÆÂêçÁß∞Áî® ÊñáÊú¨Ê°Ü‰∏îÊìç‰Ωú‰∏çÂèØ -->
                        <div class="form-group readonly-field"
                            th:if="${(selectedinfo==null) || (#strings.isEmpty(selectedinfo.lessonId))}">
                            <label>Â≠êÁßëÁõÆÂêçÁß∞</label>
                            <input id="subjectSubName" name="subjectSubName" type="text"
                                th:value="${selectedinfo != null ? selectedinfo.subjectSubName : ''}" readonly>
                            <input id="subjectSubId" name="subjectSubId" type="hidden"
                                th:value="${selectedinfo != null ? selectedinfo.subjectSubId : ''}">
                        </div>

                        <!-- Â§âÊõ¥Á∑®ÈõÜ Ê®°Âºè‰∏ã ÁßëÁõÆÂêçÁß∞Áî® ÊñáÊú¨Ê°Ü‰∏îreadonlyÊòæÁ§∫ -->
                        <div class="form-group readonly-field" th:if="${selectedinfo!=null && (!#strings.isEmpty(selectedinfo.lessonId))}">
                            <label>ÁßëÁõÆÂêçÁß∞</label>
                            <input name="subjectName" type="text" class="form-control"
                                th:value="${selectedinfo.subjectName}" readonly>
                            <input name="subjectId" type="hidden" th:value="${selectedinfo.subjectId}">
                            <input name="delFlg" type="hidden" th:value="${selectedinfo.delFlg}">
                        </div>

                        <!-- Â§âÊõ¥Á∑®ÈõÜ Ê®°Âºè‰∏ã Â≠êÁßëÁõÆÂêçÁß∞Áî® ÊñáÊú¨Ê°Ü‰∏îÊìç‰Ωú‰∏ç -->
                        <div class="form-group readonly-field" th:if="${selectedinfo!=null && (!#strings.isEmpty(selectedinfo.lessonId))}">
                            <label>Â≠êÁßëÁõÆÂêçÁß∞</label>
                            <input name="subjectSubName" type="text" th:value="${selectedinfo.subjectSubName}" readonly>
                            <input name="subjectSubId" type="hidden" th:value="${selectedinfo.subjectSubId}">
                        </div>

                        <!-- Êñ∞Ë¶èÁôªÈå≤ Ê®°Âºè‰∏ãÁöÑËØæÁ®ãÂ±ûÊÄß ‰ΩøÁî® Radio button -->
                        <div class="form-group"
                            th:if="${(selectedinfo==null) || (#strings.isEmpty(selectedinfo.lessonId))}">
                            <label>ËØæÁ®ãÂ±ûÊÄß</label>
                            <div class="radio-group">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="lessonType" id="option0" value="0"
                                        th:checked="${selectedinfo != null and selectedinfo.lessonType == 0}">
                                    <label class="form-check-label" for="option0">ËØæÁªìÁÆóÔºàÁßëÁõÆÊåâËØæÊó∂ÁªìÁÆóÁöÑÂ≠¶ÁîüÔºâ</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="lessonType" id="option1" value="1"
                                        th:checked="${selectedinfo != null and selectedinfo.lessonType == 1}">
                                    <label class="form-check-label" for="option1">ÊúàËÆ°ÂàíÔºàÁßëÁõÆÊåâÊúà‰∫§Ë¥πÂ≠¶ÁîüÔºâ</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="lessonType" id="option2" value="2"
                                        th:checked="${selectedinfo != null and selectedinfo.lessonType == 2}">
                                    <label class="form-check-label" for="option2">ÊúàÂä†ËØæÔºàÁßëÁõÆÂØπÊåâÊúà‰∫§Ë¥πÂ≠¶ÁîüÔºâ</label>
                                </div>
                            </div>
                        </div>

                        <!-- ÂèòÊõ¥ÁºñËæë Ê®°Âºè‰∏ãÁöÑËØæÁ®ãÂ±ûÊÄß ‰ΩøÁî® ÊñáÊú¨Ê°Ü -->
                        <div class="form-group readonly-field" th:if="${selectedinfo!=null && (!#strings.isEmpty(selectedinfo.lessonId))}">
                            <label>ËØæÁ®ãÂ±ûÊÄß</label>
                            <!-- ÊòæÁ§∫Áî®ÁöÑÊñáÊú¨Ê°ÜÔºåÁî®Êà∑Êó†Ê≥ïÁºñËæë -->
                            <input type="text" class="form-control"
                                th:value="${selectedinfo.lessonType == 0 ? 'ËØæÁªìÁÆó' : (selectedinfo.lessonType == 1 ? 'ÊúàËÆ°Âàí' : 'ÊúàÂä†ËØæ')}"
                                readonly>
                            <!-- ÈöêËóèÁöÑÂÆûÈôÖÊèê‰∫§ÂÄºÁöÑËæìÂÖ•Ê°Ü -->
                            <input name="lessonType" type="hidden" th:value="${selectedinfo.lessonType}">
                        </div>

                        <!-- Êñ∞ËßÑÁôªÈôÜÔºåÂèòÊõ¥ÁºñËæë ‰∏ãÊãâÂàóË°®Ê°Ü ÈÄâÊã©Â≠¶Áîü‰∏äËØæÊó∂Èïø -->
                        <div class="form-group">
                            <label>‰∏äËØæÊó∂Èïø</label>
                            <select class="form-control" name="classDuration" id="lsnduration">
                                <option value="">ËØ∑ÈÄâÊã©‰∏äËØæÊó∂Èïø </option>
                                <option th:selected="${selectedinfo!=null}?${selectedinfo.classDuration}==${element}"
                                    th:each="element:${duration}" th:value="${element}" th:utext="${element}">
                                </option>
                                </option>
                            </select>
                        </div>
                        
                        <!-- ËÆ°Âàí‰∏äËØæÊó•Êúü - ‰ΩøÁî®textËæìÂÖ•ÈÖçÂêàpattern -->
                        <div class="form-group">
                            <label>ËÆ°Âàí‰∏äËØæÊó•ÊúüÔºö</label>
                            <input id="schedualDateInput" name="schedualDate" type="text"
                                class="form-control"
                                th:value="${selectedinfo!=null}?${#dates.format(selectedinfo.schedualDate, 'yyyy-MM-dd HH:mm')}"
                                placeholder="yyyy-MM-dd HH:mm" 
                                pattern="[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}"
                                title="ËØ∑ËæìÂÖ•Ê†ºÂºèÔºöyyyy-MM-dd HH:mm" />
                        </div>
                        
                        <!-- ËØæÁ®ãË∞ÉÊï¥Êó•Êúü - ‰ΩøÁî®textËæìÂÖ•ÈÖçÂêàpattern -->
                        <div class="form-group">
                            <label>ËØæÁ®ãË∞ÉÊï¥Êó•ÊúüÔºö</label>
                            <input id="adjustedDateInput" name="lsnAdjustedDate" type="text"
                                class="form-control"
                                th:value="${selectedinfo!=null}?${#dates.format(selectedinfo.lsnAdjustedDate, 'yyyy-MM-dd HH:mm')}"
                                placeholder="yyyy-MM-dd HH:mm" 
                                pattern="[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}"
                                title="ËØ∑ËæìÂÖ•Ê†ºÂºèÔºöyyyy-MM-dd HH:mm" />
                        </div>

                        <div class="form-group">
                            <label>ËØæÁ®ãÂ±ûÊÄßÂèòÊç¢Êó•ÊúüÔºàÂ≠¶ÁîüÁî®È¢ùÂ§ñËøΩÂä†ÁöÑËØæÈ°∂ÊõøÊù•Âë®ÊàñÊù•ÊúàÂì™Â§©ÁöÑËÆ°ÂàíËØæÁ®ãÔºâ</label>
                            <input name="extraToDurDate" type="date" class="form-control"
                                th:value="${selectedinfo!=null}?${#dates.format(selectedinfo.extraToDurDate, 'yyyy-MM-dd')}">
                        </div>

                        <div class="form-group">
                            <label>ÂÆûÈôÖ‰∏äËØæÊó•ÊúüÔºàÂ≠¶ÁîüÂÆûÈôÖÊù•‰∏äËØæÁöÑÊó∂Èó¥Ôºâ</label>
                            <input name="scanQrDate" type="date" class="form-control"
                                th:value="${selectedinfo!=null}?${#dates.format(selectedinfo.scanQrDate, 'yyyy-MM-dd')}">
                        </div>
                        
                        <div class="button-container">
                            <a href="javascript:history.back()" class="btn btn-back">üîô ËøîÂõû</a>
                            <button type="submit" class="btn btn-primary">üíæ ‰øùÂ≠ò</button>
                        </div>
                    </form>
                </div>
            </main>
        </div>
    </div>

    <!-- ÂºïÂÖ• Bootstrap JavaScript Âíå jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
    <script>
        // ÁÆÄÂåñÁöÑJavaScriptÔºåÊ∑ªÂä†Êó•ÊúüÊ†ºÂºèÈ™åËØÅ
        $(document).ready(function () {
            // ‰∏∫Êó•ÊúüËæìÂÖ•Ê°ÜÊ∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂ÔºåÊòæÁ§∫Êó•ÊúüÈÄâÊã©Âô®
            $('#schedualDateInput, #adjustedDateInput').on('focus', function() {
                // ‰∏¥Êó∂Êîπ‰∏∫datetime-localÊù•ÊòæÁ§∫ÈÄâÊã©Âô®
                if (this.type === 'text') {
                    this.type = 'datetime-local';
                    // ËΩ¨Êç¢Áé∞ÊúâÂÄºÁöÑÊ†ºÂºè
                    if (this.value && this.value.match(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/)) {
                        this.value = this.value.replace(' ', 'T');
                    }
                }
            });
            
            // Â§±ÂéªÁÑ¶ÁÇπÊó∂ËΩ¨Êç¢ÂõûtextÊ†ºÂºè
            $('#schedualDateInput, #adjustedDateInput').on('blur', function() {
                if (this.type === 'datetime-local') {
                    const value = this.value;
                    this.type = 'text';
                    // ËΩ¨Êç¢‰∏∫ÂêéÁ´ØÊúüÊúõÁöÑÊ†ºÂºè
                    if (value && value.includes('T')) {
                        this.value = value.replace('T', ' ');
                    }
                }
            });
        });
    </script>

    <script th:inline="javascript">
        // ‰ªéÂêéÁ´Ø‰º†ÈÄíÁöÑ stuSubList Êï∞ÊçÆ
        var jsonStuSubList = /*[[${stuSubList}]]*/[];
        var selectedStuId = /*[[${selectedinfo != null ? selectedinfo.stuId : ''}]]*/'';
        var selectedSubjectId = /*[[${selectedinfo != null ? selectedinfo.subjectId : ''}]]*/'';
        var selectedClassDuration = /*[[${selectedinfo != null ? selectedinfo.classDuration : ''}]]*/'';
        var selectedSchedualDate = /*[[${selectedinfo != null ? #dates.format(selectedinfo.schedualDate, 'yyyy-MM-dd HH:mm') : ''}]]*/'';
        var selectedAdjustedDate = /*[[${selectedinfo != null ? #dates.format(selectedinfo.lsnAdjustedDate, 'yyyy-MM-dd HH:mm') : ''}]]*/'';
        var selectedSubjectSubName = /*[[${selectedinfo != null ? selectedinfo.subjectSubName : ''}]]*/'';
        var selectedSubjectSubId = /*[[${selectedinfo != null ? selectedinfo.subjectSubId : ''}]]*/'';
        var selectedLessonType = /*[[${selectedinfo != null ? selectedinfo.lessonType : ''}]]*/'';

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÔºåÂàùÂßãÂåñÂ≠¶Áîü‰∏ãÊãâÂàóË°®ÂíåÂÖ∂‰ªñÊéß‰ª∂
        window.onload = function () {
            var studentSelect = document.getElementById('studentSelect');
            var subjectSelect = document.getElementById('subjectSelect');
            var uniqueStudentIds = new Set(); // ‰ΩøÁî®ÈõÜÂêàÊù•ÈÅøÂÖçÈáçÂ§ç

            // ‰ªé stuSubList Ê∑ªÂä†Â≠¶ÁîüÂßìÂêçÂà∞‰∏ãÊãâÂàóË°®ÔºåÁ°Æ‰øù‰∏çÈáçÂ§ç
            jsonStuSubList.forEach(function (item) {
                if (!uniqueStudentIds.has(item.stuId)) {
                    uniqueStudentIds.add(item.stuId);
                    var option = new Option(item.stuName, item.stuId);
                    studentSelect.add(option);
                }
            });

            // Â¶ÇÊûúÈ°µÈù¢Âä†ËΩΩÊó∂ÊúâÈÄâ‰∏≠ÁöÑÂ≠¶ÁîüÔºåÂàùÂßãÂåñÁßëÁõÆ‰∏ãÊãâÂàóË°®
            if (selectedStuId) {
                studentSelect.value = selectedStuId;
                updateSubjectSelect(selectedStuId, selectedSubjectId, selectedSubjectSubName, selectedSubjectSubId);
            }

            // ÁõëÂê¨Â≠¶Áîü‰∏ãÊãâÂàóË°®ÁöÑÂèòÂåñÔºåÂπ∂Êõ¥Êñ∞ËØ•ÁîüÊ≠£Âú®Â≠¶ÁöÑÁßëÁõÆ‰∏ãÊãâÂàóË°®
            studentSelect.onchange = function () {
                updateSubjectSelect(this.value, '', '', '');
            };

            // ËÆæÁΩÆ‰∏äËØæÊó∂ÈïøÁöÑÂàùÂßãÂÄº
            if (selectedClassDuration) {
                document.getElementById('lsnduration').value = selectedClassDuration;
            }

            // ËÆæÁΩÆËÆ°Âàí‰∏äËØæÊó•ÊúüÁöÑÂàùÂßãÂÄº
            if (selectedSchedualDate) {
                document.getElementById('schedualDateInput').value = selectedSchedualDate;
            }

            // ËÆæÁΩÆËØæÁ®ãË∞ÉÊï¥Êó•ÊúüÁöÑÂàùÂßãÂÄº
            if (selectedAdjustedDate) {
                document.getElementById('adjustedDateInput').value = selectedAdjustedDate;
            }

            // ËÆæÁΩÆËØæÁ®ãÂ±ûÊÄßÁöÑÂàùÂßãÂÄº
            if (selectedLessonType) {
                document.getElementById('option' + selectedLessonType).checked = true;
                updateLessonType(selectedStuId, selectedSubjectId);
            }
        };

        // Ê†πÊçÆÈÄâ‰∏≠ÁöÑÂ≠¶Áîü ID Êõ¥Êñ∞ÁßëÁõÆ‰∏ãÊãâÂàóË°®
        function updateSubjectSelect(stuId, selectedSubjectId, selectedSubjectSubName, selectedSubjectSubId) {
            var subjectSelect = document.getElementById('subjectSelect');
            var subjectSubNameInput = document.getElementById('subjectSubName');
            subjectSubNameInput.readonly = true;
            var subjectSubIdInput = document.getElementById('subjectSubId');
            subjectSelect.innerHTML = '<option value="">ËØ∑ÈÄâÊã©</option>'; // Ê∏ÖÁ©∫Áé∞ÊúâÁöÑÁßëÁõÆÈÄâÈ°π

            // Ê∑ªÂä†‰∏éÈÄâ‰∏≠Â≠¶Áîü ID Áõ∏ÂÖ≥ÁöÑÁßëÁõÆÂà∞ÁßëÁõÆ‰∏ãÊãâÂàóË°®
            jsonStuSubList.forEach(function (item) {
                if (item.stuId === stuId) {
                    var option = new Option(item.subjectName, item.subjectId);
                    subjectSelect.add(option);
                }
            });

            // ËÆæÁΩÆÁßëÁõÆ‰∏ãÊãâÂàóË°®ÁöÑÂàùÂßãÂÄº
            if (selectedSubjectId) {
                subjectSelect.value = selectedSubjectId;
                subjectSubNameInput.value = selectedSubjectSubName;
                subjectSubIdInput.value = selectedSubjectSubId;
            }

            // ÁõëÂê¨ÁßëÁõÆ‰∏ãÊãâÂàóË°®ÁöÑÂèòÂåñÔºåÂπ∂Êõ¥Êñ∞ËØæÁ®ãÂ±ûÊÄßÁöÑ radio buttonÂíå„ÄäÂ≠¶ÁîüÊ°£Ê°à„ÄãË°®ÈáåËÆæÁΩÆÁöÑ‰∏äËØæÊó∂Èïø
            subjectSelect.onchange = function () {
                updateLessonType(stuId, this.value);
            };
        }

        // Ê†πÊçÆÈÄâ‰∏≠ÁöÑÂ≠¶Áîü ID ÂíåÁßëÁõÆ ID Êõ¥Êñ∞ËØæÁ®ãÂ±ûÊÄßÁöÑ radio buttonÂíå„ÄäÂ≠¶ÁîüÊ°£Ê°à„ÄãË°®ÈáåËÆæÁΩÆÁöÑ‰∏äËØæÊó∂Èïø
        function updateLessonType(stuId, subjectId) {
            var subjectSubNameInput = document.getElementById('subjectSubName');
            var subjectSubIdInput = document.getElementById('subjectSubId');

            // itemÊòØ‰ªév_latest_subject_info_from_student_documentËßÜÂõæÈáåÊäΩÂá∫Êù•ÁöÑÁªìÊûúÈõÜ
            var selectedItem = jsonStuSubList.find(function (item) {
                return item.stuId === stuId && item.subjectId === subjectId;
            });

            // ÈÅçÂéÜitemÔºåÊâæÂà∞‰∫ÜÂØπË±°ËÆ∞ÂΩï
            if (selectedItem) {
                // ËØæË¥πÊîØ‰ªòÁßçÂà´
                var payStyle = selectedItem.payStyle;

                // Ê†πÊçÆËØæË¥πÊîØ‰ªòÁßçÂà´Êù•Êõ¥Êñ∞ËØæÁ®ãÂ±ûÊÄßÁöÑ radio button
                if (payStyle === 0) {
                    document.getElementById("option0").checked = true;
                    document.getElementById("option0").disabled = false;

                    document.getElementById("option1").disabled = true;
                    document.getElementById("option2").disabled = true;
                } else if (payStyle === 1) {
                    document.getElementById("option0").disabled = true;

                    document.getElementById("option1").checked = true;
                    document.getElementById("option1").disabled = false;

                    document.getElementById("option2").disabled = false;
                }
                // Â∞ÜËØ•Â≠¶ÁîüÁöÑËØ•ÁßëÁõÆÂú®„ÄäÂ≠¶ÁîüÊ°£Ê°à„ÄãË°®ÈáåËÆæÂÆöÁöÑ‰∏äËØæÊó∂ÈïøÂèñÂá∫Êù•
                var minutesPerLsn = selectedItem.minutesPerLsn;

                // ÊãøÂà∞‰∏äËØæÊó∂Èïø‰∏ãÊãâÂàóË°®Ê°ÜÊéß‰ª∂
                var select = document.getElementById('lsnduration');

                // ËÆæÁΩÆ‰∏ãÊãâÂàóË°®ÁöÑÈÄâÂÆöÂÄº‰∏∫ minutesPerLsn
                select.value = minutesPerLsn;

                // ËÆæÁΩÆÂ≠êÁßëÁõÆÂêçÁß∞
                subjectSubNameInput.value = selectedItem.subjectSubName;
                subjectSubIdInput.value = selectedItem.subjectSubId;
            }
        }
    </script>
</body>

</html>